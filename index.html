<!DOCTYPE html>

<html lang="en">
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
        <link href="styles.css" rel="stylesheet">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Mulish:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">


        <title>Stretch & Folds Tracker</title>
    </head>
    <body style="background-color: #FAF5EC">

        <audio src="notification.mp3" id="notificationSound"></audio>

        <!-- <div class="navbar">
                <div class="d-flex justify-content-center">
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="tracker.html">Tracker</a></li>
                        <li><a href="about.html">About</a></li>
                    </ul>
                </div>
        </div>-->

        <div class="donation">
            <p><a href="https://ko-fi.com/korniann" target="_blank">Keep the dough rising! Tip $1 to support the project. âžœ</a></p>
        </div>

        <div class="tracker-heading">
            <h1>Sourdough Stretch & Fold Tracker</h1>
        </div>

        <script>

            function toggleInputAndTimer() {
                const inputContainer = document.getElementById("set-time"); 
                const timerContainer = document.getElementById("current-time"); 
                const inputButton = document.getElementById("startButton");
                const timerButton = document.getElementById("performButton");

                inputContainer.style.display = "block";
                timerContainer.style.display = "none";
                inputButton.style.display = "block";
                timerButton.style.display = "none";

                const startButton = document.getElementById("startButton");
                startButton.addEventListener("click", () => {
                    const userInputTime = document.getElementById("userInputTime").value;

                    // Validate input (optional)
                    if (userInputTime <= 0 || isNaN(userInputTime)) {
                    alert("Please enter a valid time (greater than 0 minutes).");
                    return;
                    }

                    inputContainer.style.display = "none";
                    timerContainer.style.display = "block";
                    inputButton.style.display = "none";
                    timerButton.style.display = "block";
                });
            }

            var timerInterval;

            function incrementCounter() {
                /* Get the element reference*/
                var foldCounterElement = document.getElementById("foldCounter");
                /* Extract the current value as a number*/
                var foldsNumber = parseInt(foldCounterElement.textContent);

                /* Increase the counter value*/
                foldsNumber++;

                /* Update the display with the incremented value (converted to text)*/
                foldCounterElement.textContent = foldsNumber.toString();
            }




            function startTimer(initialTime) {
                /* Store the initial timer in seconds*/
                var timerValue = initialTime;

                /* Get a reference to the audio when the timer ends*/
                var notificationSound = document.getElementById("notificationSound");

                /* Get a reference to the HTML element that displays the remaining timer value*/
                var timerDisplay = document.getElementById("timerDisplay");

                    /* Define an inner function that will handle the timer and sound*/
                    function updateTimer() {
                        /* Decrease the timer variable by 1*/
                        timerValue--;

                        /* Convert the remaining timerValue to minutes and seconds*/
                        var minutes = Math.floor(timerValue / 60);
                        var seconds = timerValue % 60;
                        timerDisplay.textContent = minutes + ":" + seconds.toString().padStart(2, "0");

                        /* If timerValue reaches 0, play the notification */
                        if (timerValue === 0) {
                            clearInterval(timerInterval);
                            /* Play the notification sound*/
                            notificationSound.play();
                        }
                    }
                    clearInterval(timerInterval);
                    /* Start the timer loop, calling updateTimer every second*/
                    timerInterval = setInterval(updateTimer, 1000);

            }


            /* A function that is linked to the button which starts the timer and increments the counter*/
            function performStretchAndFold() {

                /* Call incrementCounter() here */
                incrementCounter();

                /* Get user input time */
                var userInputTime = document.getElementById("userInputTime").value;

                /* Validate user input */
                if (userInputTime <= 0 || isNaN(userInputTime)) {
                    alert("Please enter a valid time (greater than 0 minutes).");
                    /* Exit function if invalid input */
                    return; 
                }

                /* Convert minutes to seconds */
                var timerValue = parseInt(userInputTime, 10) * 60;

                document.getElementById("timerDisplay").textContent = userInputTime + ":00";
                clearInterval(timerInterval);
                /* Pass user input as argument */
                startTimer(timerValue); 
                }


            function resetCounterAndTimer() {
                /* Stop the timer*/
                clearInterval(timerInterval);

                /* Reset the fold counter value to 0*/
                var foldCounterElement = document.getElementById("foldCounter");
                foldCounterElement.textContent = 0;

                /* Get a reference to the HTML element that displays the remaining timer value*/
                var timerDisplay = document.getElementById("timerDisplay");
                timerDisplay.textContent = 0;

                /* Call toggleInputAndTimer() to revert the display */
                toggleInputAndTimer();
            }


            /* A script for making the donation bar appear after a delay */
            document.addEventListener("DOMContentLoaded", function() {
                /* Call the toggle function */ 
                toggleInputAndTimer();


                setTimeout(function() {
                document.querySelector('.donation').classList.add('show');
                /* Delay adding the class by 5 minutes (the setTimeout uses ms) */
                }, 300*1000); 
            });


        </script>


        <div class="tracker">

            <div class="folds-outer">
                <div class="folds">
                    <h2>FOLDS COMPLETED:</h2>
                    <span id="foldCounter">0</span>
                </div>
                <button onclick="resetCounterAndTimer()" class="reset" id="resetButton">Reset the tracker</button>
            </div>
            
        
            <div class="time-outer">
                <div class="set-time" id="set-time">
                    <h2>FERMENTATION TIME:</h2>
                    <span>
                        <input type="number" id="userInputTime" placeholder="0 min">
                    </span>
                </div>
                    <button onclick="performStretchAndFold()" class="perform" id="startButton">Set the timer</button>
                

                <div class="current-time" id="current-time">
                    <h2>TIME REMAINING:</h2>
                    <span id="timerDisplay">0</span>
                </div>
                    <button onclick="performStretchAndFold()" class="perform" id="performButton">Perform a stretch & fold</button>
                </div>
            </div>
        </div>

        <footer class="footer">
            <div>
                <p><a href="privacypolicy.html">Privacy Policy</a></p>
                <p>Author: Kornelija Anttila</p>
            </div>
        </footer>
    </body>
</html>
